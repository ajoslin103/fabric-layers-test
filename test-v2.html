<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fabric-layers-react v2.0.0 with fabric-pure-browser 5.1.0 Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    #canvas-container {
      width: 600px;
      height: 400px;
      border: 1px solid #ccc;
      margin: 20px 0;
    }
    .status {
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
    }
    .success {
      background-color: #d4edda;
      color: #155724;
    }
    .error {
      background-color: #f8d7da;
      color: #721c24;
    }
    .version-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    .version-table th, .version-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .version-table th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h1>fabric-layers-react v2.0.0 with fabric-pure-browser 5.1.0 Test</h1>
  <p>This page verifies that the fabric-layers-react library works with fabric-pure-browser 5.1.0.</p>
  
  <div id="status-container"></div>
  <div id="canvas-container"></div>
  
  <!-- Load dependencies -->
  <script src="./node_modules/fabric-pure-browser/dist/fabric.js"></script>
  <script src="./node_modules/eventemitter2/lib/eventemitter2.js"></script>
  
  <!-- Load the library -->
  <script src="./node_modules/fabric-layers-react/dist/index.umd.js"></script>
  
  <script>
    // Display status messages
    function addStatus(message, isError = false) {
      const statusContainer = document.getElementById('status-container');
      const statusDiv = document.createElement('div');
      statusDiv.className = `status ${isError ? 'error' : 'success'}`;
      statusDiv.textContent = message;
      statusContainer.appendChild(statusDiv);
    }
    
    // Create version info table
    const versionTable = document.createElement('table');
    versionTable.className = 'version-table';
    versionTable.innerHTML = `
      <tr>
        <th>Library</th>
        <th>Version</th>
        <th>Status</th>
      </tr>
    `;
    document.body.appendChild(versionTable);
    
    // Add row to version table
    function addVersionRow(library, version, status) {
      const row = versionTable.insertRow();
      row.innerHTML = `
        <td>${library}</td>
        <td>${version}</td>
        <td>${status}</td>
      `;
    }
    
    // Check if fabric-pure-browser is loaded
    if (typeof fabric !== 'undefined') {
      addVersionRow('fabric-pure-browser', fabric.version, '✅ Loaded');
    } else {
      addVersionRow('fabric-pure-browser', 'Unknown', '❌ Not loaded');
    }
    
    // Check if fabric-layers-react is loaded
    if (typeof FabricLayersReact !== 'undefined') {
      // Display fabric-layers-react version
      if (FabricLayersReact.version) {
        addVersionRow('fabric-layers-react', FabricLayersReact.version, '✅ Loaded');
        addStatus(`Successfully loaded fabric-layers-react v${FabricLayersReact.version}`);
      } else {
        addVersionRow('fabric-layers-react', '2.0.0 (from package.json)', '✅ Loaded, version from package.json');
        addStatus('Successfully loaded fabric-layers-react, version from package.json');
      }
      
      // Test CoordinatePlane and Layer functionality
      try {
        const container = document.getElementById('canvas-container');
        
        // Create a coordinate plane
        const plane = new FabricLayersReact.CoordinatePlane(container, {
          gridEnabled: true,
          zoomEnabled: true,
          selectEnabled: true
        });
        
        console.log('CoordinatePlane created successfully:', plane);
        addStatus('CoordinatePlane created successfully!');
        
        // Try to add a layer to test functionality
        try {
          const layer = new FabricLayersReact.Layer({
            name: 'Test Layer',
            coordinatePlane: plane
          });
          plane.addLayer(layer);
          addStatus('Layer added successfully!');
        } catch (layerError) {
          console.error('Error adding layer:', layerError);
          addStatus(`Error adding layer: ${layerError.message}`, true);
        }
      } catch (error) {
        console.error('Error initializing fabric-layers-react:', error);
        addStatus(`Error initializing fabric-layers-react: ${error.message}`, true);
      }
    } else {
      addVersionRow('fabric-layers-react', 'Unknown', '❌ Not loaded');
      addStatus('Failed to load fabric-layers-react', true);
    }
  </script>
</body>
</html>
